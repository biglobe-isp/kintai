<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jee="http://www.springframework.org/schema/jee"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd

           http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd">

    <beans profile="development,testing,staging,production">
        <!--
          MailSenderインタフェースの実装クラスを定義しておくと、実際にメール通知を送ることができる。
          MailSenderの定義がない場合、ログファイルに通知内容を記録する。
        -->

        <!-- TomcatのSMTP設定を、JNDI経由で取得 -->
        <jee:jndi-lookup id="mailSession" jndi-name="mail/session"/>

        <!-- JNDIで取得したMailSession情報を利用して MailSenderクラスを定義 -->
        <bean class="org.springframework.mail.javamail.JavaMailSenderImpl">
            <property name="defaultEncoding" value="UTF-8"/>
            <property name="session" ref="mailSession"/>
        </bean>
    </beans>

    <!-- テスト用の疑似メールサーバ用の定義 -->
    <beans profile="mail-test">
        <bean class="org.springframework.mail.javamail.JavaMailSenderImpl">
            <property name="defaultEncoding" value="UTF-8"/>
            <property name="host" value="localhost"/>
            <property name="port" value="2500"/>
        </bean>
    </beans>
</beans>
