@startuml

package Datasource {
class AttendanceRecordRepositoryCSV {
-attendanceRecords : AttendanceRecords
+insert(AttendanceRecord)
+load()
+save()
}
}

package Domain {
class Year {
-year:int
+getYear()
}
class Month {
-month:int
+getMonth()
}
class Day {
-day:int
+getDay()
}
class WorkingDate {
-year : Year
-month : Month
-day : Day
getYearMonth()
getDate()
}


WorkingDate *-down- Year
WorkingDate *-down- Month
WorkingDate *-down- Day

class YearMonth {
-year :  Year
-month : Month
+YearMonth(Year,Month)
+getYearMonth() : YearMonth
}

YearMonth *-down= Year
YearMonth *-down- Month

class EntryTime {
-hour : Hour
-minute : Minute
+getHour() : Hour
+getMinutes() : Minute
}

class Hour {
-hour : int
+getHour
}

class Minute {
-minute : int
+getMinute()
}

EntryTime *-right- Hour
EntryTime *-right- Minute

class WorkingDuration {
-startTime :  EntryTime
-endTime : EntryTime
getStartTime() : EntryTime
getEndTime() : EntryTime
}

WorkingDuration *-down- EntryTime  : have 2 

class RegularWorkDurationRule {
-REGULAR_WORKING_HOURS : int
-REGULAR_WORKING_MINUTES : int
+calculateRegularWorkingHours()
+calculateOvertimeWorkingHours()
}

class FireConditionRule {
-MUST_ARRIVAL_TIME : int
+isEmployeeFired(AttendanceRecords) : bool
}

class BreakTimeRule {
+calculateTotalWorkingHours()
}

enum BreakTimes {
LUNCH_BREAK_TIME,
EVENING_BREAK_TIME,
LATE_NIGHT_BREAK_TIME
}

BreakTimeRule *-down- BreakTimes


class OverTimeRule {
-FinalCutHours : int
-FinalCutMinutes : int
-FinalCutTime : EntryTime
+adjustAttendanceRecord()
}

class AttendanceRecords {
-List<AttendanceRecord>
+AttendanceRecords(List<AttendanceRecord>)
+insert(AttendanceRecord)
+getAttendanceRecord() : List<AttendanceRecord>
}

class AttendanceRecord {
-workingDate : WorkingDate
-workingDuration : WorkingDuration
+getWorkingDate() : WorkingDate
+getWorkingDuration() : WorkingDuration
}

AttendanceRecords *-down- AttendanceRecord 

interface AttendanceRecordRepository {
-record: AttendanceRecords
+insert(AttendanceRecord)
+load()
+save()
}

class AttendanceSummaryCalculator {
+calculate() : Either<AttendanceSummaryFailed,AttendanceSummary>
}

class AttendanceSummary {
-regularWorkingHours : Duration
-overTimeWorkingHours : Duration
+get() : AttendanceSummary
+getRegularWorkingHours() : long
+getRegularWorkingMinutes() : long
}

Enum AttendanceSummaryFailed {
-FIRED
}


}
package API {
class AttendanceRecordMain
class CommandLineParser
}
package Service
{
class AttendanceRecordUpdateService {
+update(AttendanceRecord)
}
class AttendanceRecordSummaryService
{
+summary(YearMonth) : Either<AttendanceSummaryFailed,AttendanceSummary>
}

AttendanceRecordUpdateService -->  AttendanceRecordRepository 
AttendanceRecordSummaryService --> YearMonth 
AttendanceRecordSummaryService --> AttendanceRecordRepository
AttendanceRecordSummaryService --> AttendanceSummaryCalculator 
AttendanceSummaryCalculator --> FireConditionRule 
AttendanceSummaryCalculator --> AttendanceSummary
AttendanceSummaryCalculator --> AttendanceSummaryFailed


AttendanceSummary --> OverTimeRule
AttendanceSummary --> BreakTimeRule
AttendanceSummary --> RegularWorkDurationRule

AttendanceRecordMain --> CommandLineParser
AttendanceRecordMain --> AttendanceRecordUpdateService
AttendanceRecordMain --> AttendanceRecordSummaryService

AttendanceRecord --> WorkingDate
AttendanceRecord --> WorkingDuration
AttendanceRecordRepositoryCSV  --> AttendanceRecords

AttendanceRecordRepository <|.. AttendanceRecordRepositoryCSV


@enduml
