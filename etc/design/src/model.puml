@startuml 勤怠管理

package kintai {

    package datasource {
        class 勤怠リポジトリCSV << datasource >>
    }

    package domain {

        package rule {

            class 就業規則 {
                始業時刻
                終業時刻
                通常勤務扱いとする就業時間
                最長就業時間帯
    
                boolean 就業規則を満たす勤怠入力(勤怠入力)
                
            }
    
            enum 休憩時間 {
                昼休み
                夕方休憩
                深夜休憩
    
                勤務時刻 開始時刻()
                勤務時刻 終了時刻()
            }
        }

        entity 月次勤怠 {
            勤怠年月 年月
            当月の日次勤怠 当月の日次勤怠
        }

        class 勤怠年月 {
            YearMonth value        
        }
        class 当月の日次勤怠 {
            List<日次勤怠> value
        }

        entity 日次勤怠 {
            勤怠日付 勤怠日付
            勤務時刻 開始時刻
            勤務時刻 終了時刻
            勤務時間 勤務時間()
            残業時間 残業時間()
        }

        class 勤怠日付 {
            LocalDate value        
        }

        class 勤務時刻 {
            LocalTime value        
        }

        class 勤務時間 {
            int value

            勤務時間 calc(日次勤怠) 
            勤務時間 add(勤務時間)
            勤務時間 minus(休憩時間)            
        }
        note bottom of  勤務時間
            勤務時間を集計する単位：分
            集計結果は整数値（秒単位の入力がないため）
        end note 

        class 残業時間 {
            int value
            残業時間 calc(勤務時間) 
        }
        note bottom of  残業時間
            勤務時間 - 通常勤務扱いとする就業時間
        end note 

        月次勤怠  -->  当月の日次勤怠
        当月の日次勤怠  "1" o-- "0..31" 日次勤怠

        月次勤怠-->勤怠年月
        月次勤怠-->勤務時間

        日次勤怠-->勤怠日付
        日次勤怠-->勤務時刻
        日次勤怠-->勤務時間
        日次勤怠-->残業時間        
    }

    package service {

        class 勤怠管理サービス << service >> {
            void 勤怠入力(日次勤怠)
            月次勤怠 集計(勤怠年月)
        }

        interface 勤怠リポジトリ << repository >> {
            void persist(日次勤怠)
            Option<月次勤怠> findMonthlyAttendance()
        }

        勤怠管理サービス-->勤怠リポジトリ
        勤怠リポジトリ->月次勤怠
        勤怠リポジトリ->日次勤怠

        勤怠リポジトリ<|... 勤怠リポジトリCSV
    }

    package api {

        class 勤怠管理メイン {
            void main(String[] args)
        }

        class 勤怠入力 {
            日付
            開始時刻
            終了時刻
        }

        class 集計結果 {
            勤務時間
            残業時間
        }

        勤怠管理メイン--->勤怠管理サービス

    }
}

@enduml
